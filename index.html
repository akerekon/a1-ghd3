<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Chess Board Visualizer</title>
  </head>

  <body style="background-color: gray;">
    <div id="container"></div>
  </body>

  <script src="https://d3js.org/d3.v6.min.js"></script>

  <script>
    console.log(d3);

    // Add an SVG
    // Per https://d3js.org/getting-started, setup width, height, and SVG
    
    // Rely on width being no greater than the height, to keep square dimensions
    // Scale down by 0.75 to better fit on the screen
    const CHESS_WIDTH = 0.75 * window.screen.height;
    const CHESS_HEIGHT = 0.75 * window.screen.height;

    const PIECES_WIDTH = 0.2 * window.screen.width;
    const PIECES_HEIGHT = 0.2 * window.screen.height;

    const START_X_OFFSET = 50;
    const START_Y_OFFSET = 25;

    const svg = d3.create("svg").attr("width", CHESS_WIDTH + PIECES_WIDTH + START_X_OFFSET).attr("height", CHESS_HEIGHT + PIECES_HEIGHT + START_Y_OFFSET);
    const g = svg.append("g") //Graphics tag to group graphics elements

    const CHESS_BOARD_SIZE = 8;
    const SQUARE_SIZE = ((CHESS_WIDTH - START_X_OFFSET) / CHESS_BOARD_SIZE);

    let x = (CHESS_WIDTH / 2) - ((CHESS_BOARD_SIZE / 2) * SQUARE_SIZE);
    let y = (CHESS_HEIGHT / 2) - ((CHESS_BOARD_SIZE / 2) * SQUARE_SIZE);

    g.append("text")
        .attr('x', START_X_OFFSET + (window.screen.height / 2))
        .attr('y', START_Y_OFFSET)
        .attr("text-anchor", "middle")
        .attr("font-weight", "bold")
        .attr("font-size", "2em")
        .text("Chess Visualizer -- CS573 A1 by Andrew Kerekon");

    // Add Rectangles
    // Reference https://d3-graph-gallery.com/graph/shape.html as a starting point
    // Reference https://jonathansoma.com/lede/storytelling/d3/text-elements/ for text
    const generateChessBoard = () => {
      for (let row_i = 0; row_i < CHESS_BOARD_SIZE; row_i++) {
        for (let column_i = 0; column_i < CHESS_BOARD_SIZE; column_i++) {
          let fill_color = (row_i % 2 == column_i % 2) ? "#f5e6bf" : "#664439"; 
          g.append('rect')
            .attr('x', START_X_OFFSET + x + (SQUARE_SIZE * column_i))
            .attr('y', START_Y_OFFSET + y + (SQUARE_SIZE * row_i))
            .attr('width', SQUARE_SIZE)
            .attr('height', SQUARE_SIZE)
            .attr('stroke', 'black')
            .attr('fill', fill_color);
          
          let square_name = String.fromCharCode(column_i + 97) + (8 - row_i).toString();
          g.append("text")
            .attr('x', START_X_OFFSET + x + (SQUARE_SIZE * column_i) + (SQUARE_SIZE / 2))
            .attr('y', START_Y_OFFSET + y + (SQUARE_SIZE * row_i) + (SQUARE_SIZE / 2))
            .attr("text-anchor", "middle")
            .attr("font-style", "italic")
            .attr("font-weight", "bold")
            .attr("fill", "black")
            .text(square_name);
        }
      }
    }
    generateChessBoard()

    // Add Circles
    // Add Lines
    // Add Polygons
    // Reference https://d3-graph-gallery.com/graph/shape.html as a starting point
    // Reference https://stackoverflow.com/a/46138980 as a starting point
    // Reference https://webdva.github.io/how-to-draw-a-line-in-d3js/ as a starting point
    // Reference https://d3js.org/d3-shape/arc for curved lines
    const generatePieces = () => {

      //Heading
      let local_left_x = START_X_OFFSET + CHESS_WIDTH
      let local_left_y = START_Y_OFFSET + 75
      g.append("polygon")
          .attr("points", local_left_x + "," + local_left_y + " "
            + (local_left_x + 0.5*(PIECES_WIDTH/4)) + "," + (local_left_y - 50) + " "
            + (local_left_x + 2.5*(PIECES_WIDTH/4)) + "," + (local_left_y - 50) + " "
            + (local_left_x + 3*(PIECES_WIDTH/4)) + "," + (local_left_y))
          .style("fill", "#756059")
          .style("stroke", "black")
          .style("strokeWidth", "10px");
      g.append("text")
        .attr('x', (local_left_x + 1.5*(PIECES_WIDTH/4)))
        .attr('y', local_left_y - 15)
        .attr("text-anchor", "middle")
        .attr("font-weight", "bold")
        .attr("font-size", "2em")
        .text("Piece Info");
      g.append("text")
        .attr('x', (local_left_x + 1.5*(PIECES_WIDTH/4)))
        .attr('y', local_left_y + 15)
        .attr("text-anchor", "middle")
        .attr("font-weight", "bold")
        .attr("font-size", "1em")
        .text("Hover to learn about each piece!");

      //Pawn
      g.append('circle')
        .attr('cx', START_X_OFFSET + 1.05*CHESS_WIDTH)
        .attr('cy', START_Y_OFFSET + 2*(SQUARE_SIZE))
        .attr('r', (SQUARE_SIZE / 4))
        .attr('fill', "white");

      g.append('line')
        .attr('stroke', 'white')
        .style("stroke-width", 10)
        .attr("x1", START_X_OFFSET + 1.05*CHESS_WIDTH - (SQUARE_SIZE / 4))
        .attr("y1", START_Y_OFFSET + 2*(SQUARE_SIZE) + (SQUARE_SIZE / 4))
        .attr("x2", START_X_OFFSET + 1.05*CHESS_WIDTH + (SQUARE_SIZE / 4))
        .attr("y2", START_Y_OFFSET + 2*(SQUARE_SIZE) + (SQUARE_SIZE / 4));
    }
    generatePieces()

    // Per https://d3js.org/getting-started, add svg node to our div container
    container.append(svg.node())
  </script>
</html>
